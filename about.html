<html>

<head>
<script type="text/javascript" src="paper.js"></script>
<script type="text/javascript">
	const BLACK = 'black', BLUE = 'rgb(100,135,225)'
	const DRIFT_SPEED = Math.random()*0.1+0.02;
	const quadrantDecomposeTable = [[], [false,false], [false,true], [true,true], [true,false]]
	const N_OF_ORIGINAL_LINES = 73

	var currentDrawing;
	var allLetters = [];
	var links = [];
	
	mode = Math.round(Math.random()*3)

	var selectedUrl = ""
	var mouse = {x:0,y:0};
	function mousemove(e) {
		mouse.x = e.clientX
		mouse.y = e.clientY

		selectedUrl = ""
		links.forEach(link=>{
			if (link.distanceTo(mouse) < 70) {
				link.selecter.visible = true
				link.color(BLUE)
				selectedUrl = link.url
			} else {
				link.selecter.visible = false
				link.color(BLACK)
			}
		})
	}
	// Only executed our code once the DOM is ready.
	window.onload = function() {
		// Get a reference to the canvas object
		var canvas = document.getElementById('myCanvas');
		canvas.onmousemove = mousemove


		canvas.onclick = ()=>{if(selectedUrl)window.location=selectedUrl}
		// Create an empty project and a view for the canvas:
		paper.setup(canvas);

		var {width, height} = paper.view.context.canvas
		paper.view.onMouseDown = function (event) {
			currentDrawing = new paper.Path();
			currentDrawing.strokeColor = 'blue';
		}

		paper.view.onMouseDrag = function(event) {
			currentDrawing.add(event.point);
		}

		paper.view.onMouseUp =function(event) {
			/* 
				add the path to the array of all paths
			*/
			
			currentDrawing.simplify()
			// extract "originalPoints"
			currentDrawing.originalPoints = currentDrawing.segments.map(function(segment){return {x: segment.point.x, y:segment.point.y}})
			// set offset thing so it doesnt crash later (related to continential drift)
			currentDrawing.offset = {x:0, y:0}
			// add it
		    allLetters.push(currentDrawing)

		    /*
		    	save all edits to localstorage 
		    */

		    // replace the points with their original (before random shiftings)
		    for (line of allLetters.slice(N_OF_ORIGINAL_LINES)) {
		    	line.segments = line.segments.map((segment, i)=>{
		    		segment.point = line.originalPoints[i]
		    		return segment
		    	})
		    }
		    // set it
		    localStorage.setItem("doodles", JSON.stringify(allLetters.slice(N_OF_ORIGINAL_LINES)))
		}

		function range(min,max) { let array = []; for (let i=min; i<=max; i++) { array.push(i) } return array}
		
		paper.view.onFrame = function(event) {
			// continental drift
			for (continent of continents) {
				continent.offset = continent.offset.add(continent.velocity);
				shifted_pos = continent.position.add(continent.offset)

				let [moving_up, moving_left] = quadrantDecomposeTable[continent.velocity.getQuadrant()] // Quadrants { 1:dr, 2:dl, 3:ul, 4:dr }
				if (moving_up && shifted_pos.y < 100) continent.velocity.angle = 90 + (270-continent.velocity.angle)
				if (moving_left && shifted_pos.x < 300) continent.velocity.angle = 0 + (180-continent.velocity.angle)
				if (!moving_up && shifted_pos.y > height-100) continent.velocity.angle = 270 + (90-continent.velocity.angle)
				if (!moving_left && shifted_pos.x > width-100) continent.velocity.angle = 180 + (0-continent.velocity.angle)
				
				for (shape of continent.indices) {
					allLetters[shape].offset = continent.offset
				}
			}

			// character shake
			allLetters.forEach(function(character,j){
				character.originalPoints.forEach(function(point,index){
					if (50<j&&j<55) amplitude = 3
					else {
						let sqrDistance = (point.x+allLetters[j].offset.x-mouse.x)**2 + (point.y+allLetters[j].offset.y-mouse.y)**2
						if (mode==1) amplitude = Math.sqrt(sqrDistance)/10
						else if (mode==3) amplitude = Math.sqrt((sqrDistance)/32768)*16
						else if (mode==2) amplitude = Math.log(sqrDistance)/2
						else if (mode==4) amplitude = 0
						else amplitude = sqrDistance/0b100000000000
					}
			        allLetters[j].segments[index].point.x = point.x + (Math.random()-0.5)*amplitude +allLetters[j].offset.x;
			        allLetters[j].segments[index].point.y = point.y + (Math.random()-0.5)*amplitude +allLetters[j].offset.y;
			    })   
			})
		}

		// load the drawn stuff
		imported = [["Path",{"applyMatrix":true,"segments":[[[115,49],[0,0],[-2.9029,23.2232]],[[105,118],[5.7322,-22.9288],[-1,4]],[[102,130],[0.51141,-4.09127],[-0.29235,2.33882]],[[101,137],136.55412],[[104,126],[-1.14448,3.62417],[2.36795,-7.4985]],[[129,101],[-10.95345,-19.16854],[1.56893,2.74563]],[[132,110],[-0.56569,-3.11127],[0.71802,3.94912]],[[133,122],[0,-4.01386],[0,7.24844]],[[129,143],[0,-6.88236],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[153,107],[0,0],[0,17.57593]],[[147,159],[0,-17.11478],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[227,45],[0,0],[0,23.63702]],[[213,113],[3.46461,-23.09738],[-0.44776,2.98507]],[[212,122],[0.16743,-3.01381],[-0.44945,8.09013]],[[210,146],[1.32166,-7.92994],[-0.21734,1.30405]],[[207,154],[1.51508,0],[-1.69967,0]],[[206,149],[1.20185,1.20185],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[201,91],[0,0],[10.98403,-3.66134]],[[233,75],[-10.43742,5.21871],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[251,48],[0,0],[0,24.20616]],[[240,120],[5.22349,-23.50573],[-1.97033,8.86646]],[[234,146],[2.4991,-8.74684],[-0.75514,2.64298]],[[232,154],[0,2.74874],[0,-13.15127]],[[243,116],[-4.3893,12.29005],[0.48222,-1.35022]],[[248,105],[-2.25585,1.12793],[2.49904,-1.24952]],[[258,118],[-0.38357,-1.72608],[1.94884,8.76979]],[[256,148],[2.7398,-8.2194],[-0.3547,1.06411]],[[252,157],156.82725],[[254,150],[-0.14843,0.44529],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[267,134],[0,0],[7.56105,0]],[[293,105],[0,8.2985],[0,-1]],[[290,105],[0.89443,-0.44721],[-4.0008,2.0004]],[[280,115],[2.6115,-3.482],[-6.56091,8.74789]],[[269,146],[-2.33134,-11.65669],[1.17055,5.85276]],[[287,156],[-6.10845,6.10845],[3.6467,-3.6467]],[[293,144],[-3.28098,3.28098],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[310,119],[0,0],[0,8.33333]],[[310,144],[0,-8.33333],[0,3.23303]],[[309,153],[0,-3.23303],[0,1.33333]],[[309,157],[0,1.33333],[0,-12.28584]],[[333,120],[-13.87955,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[334,138],[0,0],[4.55956,1.51985]],[[356,139],[-4.0431,4.0431],[10.95531,-10.95531]],[[343,123],[11.53278,-3.84426],[-10.46156,3.48719]],[[335,159],[-7.63751,-7.63751],[4.33934,4.33934]],[[356,156],[0,8.82866],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[395,52],[0,0],[0,16.93753]],[[393,102],[4.12311,-16.49243],[-3.98173,15.92692]],[[380,150],[0,-16.91108],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[375,168],[0,0],[4.7846,0]],[[377,162],[-1.9087,1.9087],[1.51141,-1.51141]],[[375,168],[4.36896,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[96,159],[0,0],[26.46963,2.78628]],[[175,169],[-26.24252,-3.64479],[18.02825,2.50392]],[[229,174],[-17.93579,-3.09238],[21.63603,3.73035]],[[294,186],[-21.43234,-4.59265],[10.7686,2.30756]],[[327,193],[-11.146,-0.61922],[23.32986,1.2961]],[[396,191],[-22.98884,0],[2.23607,0]],[[390,188],[2.15003,0.6143],[-2.90232,-0.82924]],[[381,187],[3.01654,0.10773],[-6.3293,-0.22605]],[[362,187],[6.33333,0],[-19.49854,0]],[[312,191],[18.26737,-3.14955],[-18.23741,3.14438]],[[257,195],[18.30766,-2.74615],[-29.49317,4.42398]],[[177,194],[29.34878,9.78293],[-11.47193,-3.82398]],[[142,184],[11.5905,2.57567],[-0.57659,-0.12813]],[[129,184],[0.96402,-0.96402],[-1.49071,1.49071]],[[135,186],[-2.1009,-0.17508],[2.67814,0.22318]],[[143,187],[-2.61598,-0.61552],[10.16277,2.39124]],[[173,196],[-10.12859,-2.53215],[9.96613,2.49153]],[[204,204],[-9.95549,-2.21233],[12.10516,2.69003]],[[242,206],[-12.29712,-0.94593],[11.21913,0.86301]],[[276,211],[-11.05442,-2.21088],[10.70164,2.14033]],[[310,214],[-10.8837,-0.98943],[3.3362,0.30329]],[[320,215],[-3.32409,-0.41551],[1.6538,0.20672]],[[325,215],[0.74536,-1.49071],[-3.14466,6.28932]],[[304,217],[7.03032,-0.13785],[-11.00293,0.21574]],[[271,218],[11.00276,-0.22455],[-5.33222,0.10882]],[[255,218],[5.32994,-0.19035],[-4.01131,0.14326]],[[243,219],[4.01008,-0.17435],[-10.71767,0.46599]],[[218,224],[7.34471,-7.34471],[-1.02221,1.02221]],[[214,228],[0,-0.99307],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[677,122],[0,0],[1.22789,6.13947]],[[682,140],[-1.3306,-5.9877],[1.79433,8.07449]],[[684,166],[-1.58627,-7.93135],[0.58809,2.94043]],[[685,176],[-2.28506,-2.28506],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[676,106],[0,0],[-1.91268,0]],[[672,100],[-2.53036,2.53036],[1.62851,-1.62851]],[[675,109],[0,-1.21862],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[693,82],[0,0],[0,11]],[[693,115],[0,-11],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[704,109],[0,0],[0,14]],[[704,151],[0,-14],[0,4.33333]],[[704,164],[0,-4.33333],[0,2.33333]],[[704,171],[2.33333,0],[-2.30546,0]],[[702,158],[0.0458,0.50376],[-1.23422,-13.5764]],[[703,116],[-6.34604,12.69207],[1.59787,-3.19575]],[[718,109],[-4.94608,-4.94608],[2.75821,2.75821]],[[720,144],[0,-5.19882],[0,4.20233]],[[721,156],[0,-4.02176],[0,1.69967]],[[722,161],[0,1.69967],[0,-10.80952]],[[725,126],[-5.37341,8.95568],[1.52919,-2.54865]],[[726,116],[-1.26072,2.52143],[1.9434,-3.88679]],[[750,114],[-0.85122,-4.25609],[2.01142,10.05708]],[[750,147],[0,-10.22702],[0,3.546]],[[751,162],[-2.49721,-2.49721],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[781,72],[0,0],[1.42248,7.11242]],[[788,92],[-1.95923,-6.85731],[1.32387,4.63353]],[[789,106],[-1.25257,-4.384],[2.56133,8.96466]],[[793,134],[0,-9.6496],[0,7.30753]],[[795,153],[0,-6.74502],[0,0.66667]],[[795,155],[-0.59628,-0.29814],[9.68763,4.84381]],[[816,128],[0,7.16424],[0,-0.91737]],[[816,115],115.0758],[[816,124],[-0.06127,-0.27572],[0.45733,2.05798]],[[818,130],[-0.5547,-2.0339],[1.91253,7.01261]],[[823,152],[-3.13247,-6.26493],[0.26667,0.53333]],[[824,153],[-1.6,0.8],[3.61726,-1.80863]],[[831,141],[-1.7071,3.41419],[1.1309,-2.2618]],[[837,135],[-0.7929,2.37869],[2.22799,-6.68396]],[[839,112],[-2.61056,6.5264],[1.68512,-4.2128]],[[843,100],[-0.40803,4.8963],[0.46307,-5.55685]],[[843,83],[0,5.60727],[0,-2]],[[843,77],[0,2],[0,-0.66667]],[[843,75],[0,-0.66667],[0,10.24514]],[[851,126],[-7.44826,-7.44826],[0.62846,0.62846]],[[858,126],[-0.85383,0],[10.17397,0]],[[870,109],[-2.59219,7.77658],[0.73786,-2.21359]],[[870,102],102.48165],[[870,114],[0,-1.14954],[0,7.42268]],[[879,136],[-5.07532,-5.07532],[0.78737,0.78737]],[[884,135],[-0.37413,0.49884],[1.83793,-2.45057]],[[897,112],[-0.97081,3.39784],[0.51405,-1.79919]],[[897,105],[0,1.94947],[0,-0.66667]],[[897,103],[0,-0.66667],[0,4.33333]],[[897,116],[0,-4.33333],[0,4]],[[897,128],[0,-4],[0,6.96935]],[[885,169],[18.16554,9.08277],[-2.10322,-1.05161]],[[888,152],[-0.38144,0.76287],[7.2291,-14.4582]],[[918,114],[-10.38091,12.45709],[2.23979,-2.68775]],[[928,101],[-3.53681,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[808,178],[0,0],[3.81225,15.249]],[[818,224],[-1.96494,-15.71951],[0.7528,6.02241]],[[823,244],[-6.88095,-3.44047],[9.10433,4.55217]],[[843,220],[-1.95713,3.91425],[0.84433,-1.68866]],[[843,212],[0,1.99703],[0,-1.33333]],[[843,208],[0,1.33333],[0,-0.66667]],[[843,206],[0,-0.66667],[0,7.49369]],[[845,228],[-0.91975,-7.35799],[0.39781,3.18245]],[[845,241],[-1.48288,-2.96577],[1.83678,3.67355]],[[855,249],[-5.38457,2.69228],[17.83636,-8.91818]],[[878,199],[0,18.59419],[0,-5.83173]],[[879,182],[-0.52919,5.82111],[0.07859,-0.86446]],[[879,175],[0.4578,1.3734],[-0.43461,-1.30384]],[[878,171],[0,-1.37437],[0,7.92262]],[[881,193],[-1.49571,-7.47855],[2.62442,13.12209]],[[889,231],[-10.18447,-10.18447],[6.01044,6.01044]],[[910,208],[-1.21844,4.87376],[1.54008,-6.16031]],[[911,197],197.42203],[[911,207],[0,-1.48229],[0,5.44284]],[[922,233],[-7.93154,1.98288],[7.47233,-1.86808]],[[941,213],[-1.17017,8.19117],[0.44588,-3.12115]],[[941,203],[0,3.17443],[0,-1.33333]],[[941,199],[-0.42164,-1.26491],[4.39366,13.18098]],[[946,266],[2.05195,-14.36366],[-1.31888,9.23218]],[[921,275],[7.37469,3.68735],[-6.66957,-3.33479]],[[931,249],[-1.28414,1.60517],[6.48118,-8.10148]],[[947,222],[-6.82706,8.19247],[9.69752,-11.63702]],[[981,189],[-10.16793,11.0521],[2.98491,-3.24447]],[[995,173],[-4.88214,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[822,265],[0,0],[12.47616,-8.31744]],[[865,254],[-13.85488,4.61829],[6.5329,-2.17763]],[[884,247],[-6.96074,1.16012],[4.59053,-0.76509]],[[903,246],[-4.11695,1.64678],[22.89271,-9.15708]],[[974,232],[-24.36422,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[618,298],[0,0],[0,16.56388]],[[618,358],[30.55787,-10.18596],[-4.80689,1.6023]],[[607,337],[0,3.73729],[0,-1]],[[607,334],[-0.89443,0.44721],[14.95748,-7.47874]],[[645,351],[-9.90792,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[626,314],[0,0],[5.58514,0]],[[643,319],[-5.30972,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[662,307],[0,0],[4.29394,2.86262]],[[675,316],[-4.44886,-2.54221],[0.7003,0.40017]],[[685,322],[1.09913,-1.09913],[-5.56003,5.56003]],[[667,337],[5.59038,-5.59038],[-0.81417,0.81417]],[[661,340],339.86961],[[670,341],[-0.79459,-0.31783],[7.43416,2.97367]],[[688,353],[-4.29954,-6.44931],[6.45158,9.67737]],[[670,373],[16.27603,16.27603],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[707,317],[0,0],[0,8.69282]],[[705,344],[-1.24297,-8.7008],[1.4032,9.82241]],[[709,372],[0,-10.55481],[0,5.04808]],[[715,396],[-4.57087,-3.04725],[6.72035,4.48023]],[[727,387],[-2.71736,3.3967],[6.22403,-7.78004]],[[737,364],[0,10.54973],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[765,334],[0,0],[-5.08079,7.62118]],[[754,355],[5.13505,-7.18907],[-1.98445,2.77823]],[[745,366],[-1.46161,-2.92323],[2.51902,5.03804]],[[766,376],[-4.24863,-3.18647],[7.29081,5.4681]],[[778,402],[0,-8.91453],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[793,359],[0,0],[8.66667,0]],[[819,359],[-8.66667,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[805,333],[0,0],[0,15.58866]],[[809,379],[0,-15.98568],[0,8.1814]],[[802,392],[4.72534,-4.72534],[-0.84304,0.84304]],[[796,395],[1.81128,1.81128],[-1.52094,-1.52094]],[[794,374],[-2.01328,2.01328],[1.38074,-1.38074]],[[806,372],[-2.12759,0],[1.32639,0]],[[815,372],[-0.95024,-0.95024],[2.83907,2.83907]],[[819,399],[0,-4.87998],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[824,350],[0,0],[5.64884,5.64884]],[[832,369],[0,-7.61072],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[838,339],[0,0],[5.84501,0]],[[869,339],[-3.97847,-1.98923],[3.50081,1.7504]],[[880,342],[-4.13964,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[843,340],[0,0],[0,13.67814]],[[838,380],[3.50323,-12.26129],[-1.06055,3.71193]],[[826,405],[2.34684,-2.34684],[-1.47625,1.47625]],[[823,406],[0,-2.63222],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[862,344],[0,0],[-2.07826,2.07826]],[[855,353],[0,-1.83258],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[848,352],[0,0],[0,7.66667]],[[848,375],[0,-7.66667],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[852,350],[0,0],[4.75714,4.75714]],[[870,353],[-1.83826,-1.83826],[1.0245,1.0245]],[[867,379],[0,-3.58072],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[852,362],[0,0],[6,0]],[[870,362],[-6,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[848,374],[0,0],[7.1525,0]],[[870,377],[-6.06493,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[849,386],[0,0],[0,3.71607]],[[839,394],[0,-3.44139],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[857,380],[0,0],[0,8.52336]],[[852,408],[2.60049,-7.80147],[-2.01713,6.05139]],[[845,404],[0,4.84368],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[861,389],[0,0],[0,2.97185]],[[863,398],[0,-3.5112],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[888,344],[0,0],[12.82759,0]],[[926,345],[-12.24889,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[906,348],[0,0],[-1.61171,1.61171]],[[899,357],[2.79351,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[888,360],[0,0],[0,4.95511]],[[886,384],[1.94759,-3.89518],[-1.73394,3.46787]],[[881,400],[0,-4.58553],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[890,359],[0,0],[2.75216,0]],[[909,359],[-1.91167,-1.91167],[1.0897,1.0897]],[[909,370],[0,-1.525],[0,8.60459]],[[906,402],[4.69835,-4.69835],[-0.52705,0.52705]],[[905,404],[0.74536,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[886,370],[0,0],[7.80594,0]],[[908,371],[-7.70567,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[886,387],[0,0],[8.05831,0]],[[911,389],[-7.9881,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[883,400],[0,0],[8.44899,0]],[[907,404],[-7.8214,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[885,407],[0,0],[-3.72696,3.72696]],[[871,419],[6.21015,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[901,410],[0,0],[9.38757,4.69378]],[[910,434],[0,-8.93157],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[939,358],[0,0],[0,14.91746]],[[936,402],[2.40283,-14.41695],[-0.81698,4.90186]],[[934,423],[-2.63092,-5.26183],[0.89492,1.78983]],[[949,424],[-2.74466,3.65955],[5.61223,-7.48297]],[[961,395],[0,9.52412],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[968,375],[0,0],[10,0]],[[998,375],[-10,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[966,388],[0,0],[5.97989,0]],[[987,389],[-5.47904,-2.19162],[3.51825,1.4073]],[[999,392],[-4.07061,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[985,360],[0,0],[0,13.5994]],[[975,412],[4.88997,-12.22493],[-1.8729,4.68224]],[[966,426],[7.4559,1.86398],[-4.32603,-1.08151]],[[962,405],[-1.86509,1.86509],[1.81787,-1.81787]],[[973,404],[-2.88125,0],[12.67091,0]],[[996,427],[0,-12.86077],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[1011,380],[0,0],[11.02768,0]],[[1043,384],[-10.80707,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[1031,361],[0,0],[0,12.78842]],[[1025,401],[6.69696,-10.04543],[-0.91807,1.37711]],[[1023,407],[2.42333,-0.80778],[-10.99913,3.66638]],[[1013,391],[-4.48282,8.96564],[0.77456,-1.54912]],[[1023,389],[-1.61205,-1.61205],[4.82966,4.82966]],[[1026,431],[0,-7.17563],[0,2.32035]],[[1023,444],[2.55819,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[841,198],[0,0],[0,-1.6547]],[[840,188],[-1.71535,1.71535],[3.17333,-3.17333]],[[845,194],[-1.65083,-0.82541],[1.07942,0.53971]],[[847,188],[-0.54654,1.09307],[0.40634,-0.81268]],[[853,187],[-0.43925,-0.87849],[3.83978,7.67955]],[[845,197],[1.26965,-1.26965],[-0.96138,0.96138]],[[844,203],[1.28349,-1.28349],[-0.73919,0.73919]],[[840,198],[0.58256,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[81,527],[0,0],[0,10]],[[81,557],[0,-10],[0,3.33333]],[[81,567],[0,-3.33333],[0,1.66667]],[[81,572],[0,1.66667],[0,-3.00339]],[[86,553],[-1.44772,0.72386],[1.65454,-0.82727]],[[95,550],[-2.4093,-2.4093],[1.2049,1.2049]],[[96,577],[0,-3.06919],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[110,555],[0,0],[-9.3184,0]],[[104,576],[-6.30239,-6.30239],[1.01652,1.01652]],[[114,575],[-0.99197,0.99197],[0.65734,-0.65734]],[[119,556],[1.8287,3.65741],[-0.12475,-0.2495]],[[115,556],[0.40728,0],[-3.6424,0]],[[106,555],[2.49228,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[126,556],[0,0],[0,6.33494]],[[123,574],[0,-6.5637],[0,0.15339]],[[123,580],580.25034],[[123,574],[0,0.78551],[0,-5.96774]],[[127,558],[-2.72386,2.72386],[0.26471,-0.26471]],[[130,558],[-0.41176,0],[1.7567,0]],[[131,574],[0,-2.23225],[0,0.66667]],[[131,576],578.30946],[[131,572],[0,1.33333],[0,-3.72668]],[[133,556],[-3.59356,0],[1.33333,0]],[[137,556],[-0.94281,-0.94281],[0.16007,0.16007]],[[137,579],[0,-2.33088],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[147,568],[0,0],[2.58958,0]],[[155,567],[-1.36577,1.36577],[4.30003,-4.30003]],[[147,559],[4.23921,-4.23921],[-0.2357,0.2357]],[[147,560],[0,-0.33333],[0,2.06759]],[[147,579],[-0.27368,-0.27368],[0.2872,0.2872]],[[158,579],[-0.55877,0.55877],[1.11596,-1.11596]],[[160,573],[0,0.90546],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[71.81527,542.28613],[0,0],[7.07107,-2.82843]],[[94.90067,533.54859],[-7.1816,2.53468],[21.24934,-7.49977]],[[159.32788,540.29216],[-20.25874,-4.50194],[13.33283,2.96285]],[[179.9356,567.26314],[5.6598,-16.9794],[-2.25574,6.76721]],[[137.52903,583.16752],[0.90185,-0.21473],[-32.58218,7.75766]],[[71.01906,585.53645],[32.76833,10.92278],[-10.85404,-3.61801]],[[50.20023,558.54398],[-2.28641,11.43207],[1.28072,-6.40359]],[[72.14304,548.99933],[0,-1.15956],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[975,259],[0,0],[0,4.93853]],[[976,273],[0,-5.16185],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[973,250],[0,0],[5.90939,5.90939]],[[998,253],[-5.28902,-5.28902],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[984,235],[0,0],[0,12.80282]],[[985,273],[0,-12.22625],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[999,235],[0,0],[0,8.33333]],[[999,260],[0,-8.33333],[0,3]],[[999,269],[0,-3],[0,1.66667]],[[999,274],[0,1.66667],[0,-2.84361]],[[1000,250],[-1.43863,0.71931],[8.71221,-4.35611]],[[1007,273],[0,-4.74162],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[1011,251],[0,0],[0,2.73566]],[[1012,270],[-1.11218,-1.11218],[0.57213,0.57213]],[[1017,270],[-0.76157,0],[7.10016,0]],[[1025,258],[0,6.25612],[0,-0.44204]],[[1025,250]],[[1025,261],[0,-0.95957],[0,2.33333]],[[1025,268],[0,-2.33333],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[1032,228],[0,0],[0,11.24956]],[[1034,261],[-3.07159,-9.21477],[0.5556,1.6668]],[[1034,269],[-1.15805,-1.15805],[0.38964,0.38964]],[[1038,269],[-0.61024,0],[8.75289,0]],[[1047,258],[0,7.98833],[0,-0.77979]],[[1047,251],[0.53782,0.26891],[-3.91732,-1.95866]],[[1032,250],[4.65395,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[952,282],[0,0],[22.88117,0]],[[1021,280],[-22.46785,3.74464],[2.61139,-0.43523]],[[1041,274],[-2.13296,1.42197],[0.5555,-0.37033]],[[1046,273]],[[1043,273],[0.94868,-0.31623],[-5.33209,1.77736]],[[1031,275],[5.68373,-0.71047],[-12.75008,1.59376]],[[993,288],[12.50225,-3.57207],[-0.81571,0.23306]],[[979,289]],[[990,289],[-1.16061,0],[9.66667,0]],[[1019,289],[-9.66667,0],[1.55501,0]],[[1028,289],[-1.04929,1.04929],[2.77857,-2.77857]],[[1016,288],[0.66671,0],[-4.40532,0]],[[993,292],[2.29979,-2.29979],[-2.60648,2.60648]],[[999,294],[-1.10242,0],[4.16961,0]],[[1020,293],[-3.08895,3.08895],[1.80906,-1.80906]],[[1018,291],[2.63775,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[965,249],[0,0],[-9.2795,0]],[[953,268],[-3.67455,-3.67455],[1.50141,1.50141]],[[965,270],[-1.88527,1.88527],[2.62832,-2.62832]],[[966,253],[0,3.74524],[0,-0.2]],[[966,250]],[[966,252],[0,-0.66667],[0,5.55708]],[[968,267],[0,-5.40638],[0,5.68015]],[[969,290],[2.90288,-5.80577],[-0.14907,0.29814]],[[968,290],[0.33333,0],[-4.12437,0]],[[952,289],[2.25973,2.25973],[-1.47043,-1.47043]],[[949,283],[1.88847,1.88847],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[482,641],[0,0],[-19.06963,0]],[[461,660],[0,-18.48141],[0,1.33207]],[[461,672],[-1.25248,-1.25248],[4.55204,4.55204]],[[495,663],[0,10.77802],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[495,645],[0,0],[0,6.35651]],[[497,663],[-1.23476,-6.1738],[0.35878,1.7939]],[[497,669],[0,-1.84166],[0,0.66667]],[[497,671],[0,0.66667],[0,-7.53705]],[[498,646],[-2.88952,7.22381],[1.66314,-4.15784]],[[523,644],[0,-9.54077],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[522,652],[0,0],[3.73809,0]],[[537,652],[-3.78081,1.26027],[2.27142,-0.75714]],[[539,638],[1.83908,1.83908],[-2.80651,-2.80651]],[[523,643],[0.98706,-1.97412],[-4.82221,9.64443]],[[532,668],[-3.86279,-3.86279],[2.43984,2.43984]],[[546,665],[0,2.98199],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[559,642],[0,0],[-7.10208,0]],[[551,666],[-3.64192,-3.64192],[1.02935,1.02935]],[[562,669],[-1.59031,1.59031],[0.94173,-0.94173]],[[564,642],[1.47069,2.20604],[-3.00787,-4.5118]],[[556,629],[2.59417,3.89126],[-0.7192,-1.07879]],[[554,615],[0,1.25669],[0,-0.66667]],[[554,613]],[[556,626],[-0.12231,-0.36693],[3.59693,10.79078]],[[564,659],[-4.51756,-9.03513],[1.07842,2.15685]],[[568,667],[-2.71866,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[574,642],[0,0],[0,7.66667]],[[574,665],[0,-7.66667],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[574,632],[0,0],[1.01427,0]],[[578,630],[-0.67983,0.67983],[1.2693,-1.2693]],[[573,632],[1.79505,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[578,631],[0,0],[11.47139,0]],[[611,634],[-11.43707,0],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[593,607],[0,0],[0,5.14007]],[[593,651],[-2.55886,-5.11773],[2.22037,4.44074]],[[595,665],[0,-5.36352],[0,0]]],"strokeColor":[0,0,0]}],["Path",{"applyMatrix":true,"segments":[[[606,638],[0,0],[3.57297,-0.71459]],[[616,637],[-3.54132,0],[3.56459,0]],[[626,634],[-3.61563,0.6026],[0.98639,-0.1644]],[[629,634]],[[622,637],[0.64924,-0.43283],[-3.99763,2.66508]],[[613,646],[2.92375,-4.38563],[-0.83324,1.24986]],[[609,654],[-2.59398,-2.59398],[0.4714,0.4714]],[[611,654],[-0.66667,0],[2.56892,0]],[[637,654],[-0.49519,0.49519],[1,-1]],[[637,648],[-1,1],[3.23539,-3.23539]],[[640,656],[1.13797,-1.13797],[-2.64016,2.64016]],[[638,648],[0,0.93813],[0,-3.63413]],[[634,637],[1.36925,4.10775],[-1.33574,-4.00722]],[[628,626],[1.7966,3.5932],[-1.46667,-2.93333]],[[628,615],[1.46667,2.93333],[-1.13922,-2.27843]],[[627,608],[0,2.77037],[0,-1.02941]],[[626,606],[-0.7451,0.7451],[0.2357,-0.2357]],[[627,606],[-0.33333,0],[2.60748,0]],[[646,604],[-2.94667,-2.94667],[0.39376,0.39376]],[[643,613],[0,-0.96625],[0,7.89248]],[[642,637],[0,-8.32741],[0,0.66667]],[[642,639],[0.4714,-0.4714],[-2.04225,2.04225]],[[639,646],[0,-4.33432],[0,0]]],"strokeColor":[0,0,0]}]];
		imported.splice(15,1)

		saved = localStorage.getItem("doodles")
		if (saved) {
			imported = imported.concat(JSON.parse(saved))
		}

		imported.forEach(([_, data])=>{
			let thisPath = new paper.Path(data)
			if (data.segments == undefined) { data.segments = [] }

			thisPath.originalPoints = data.segments.map(([[x,y]])=>{return {x:x, y:y}})
			thisPath.offset = new paper.Point()
			allLetters.push(thisPath)
		});
		[0,4,15,19,53].forEach(i=>allLetters[i].smooth()); // remove all the mysterious glitched curves
		
		function shift(indices, shift) {
			indices.forEach(i=>{
				allLetters[i].originalPoints = allLetters[i].originalPoints.map(({x,y})=>{return {x:x+(shift.x||0), y:y+(shift.y||0)}})
				allLetters[i].position = allLetters[i].position.add({x:shift.x||0, y:shift.y||0})
			})
		}
		shift([15,16,50], {y:-100}) // move the name up to be inline with the "i'm"
		shift(range(51,55), {y:-430}) // move the home way up cuz it shud always b visibile
		shift(range(0,10), {x:200, y:50}) // move the hi there! out of the way to not intersect with the new home spot

		class Link {
			constructor(lineIndices, position, url, selecter, ovalStretch = 1) {
				if (!position.x) position = {x:position[0], y:position[1]};
				this.position = new paper.Point(position)	
				this.lineIndices = lineIndices
				this.url = url
				this.ovalStretch = ovalStretch
				selecter = allLetters[selecter]
				selecter.visible=false
				selecter.strokeColor = BLUE
				this.selecter = selecter
				this.continent = continents[allLetters[lineIndices[0]].continentIndex]
				links.push(this)
			}

			distanceTo(point) {
				let true_pos = this.position.add(this.continent.offset);
				return true_pos.getDistance(point);
				//return Math.sqrt((this.position.x - point.x)**2 + ((this.position.y - point.y)*ovalStretch)**2)
			}

			color(color) {
				this.lineIndices.forEach(i=>{
					//allLetters[i]._style._values._strokeColor._components = color
					allLetters[i].strokeColor = color
				})
			}
		}


		var continents = [range(0,10), range(11,16).concat(50), range(17,49), range(51,55), range(56,63), range(64,72)].map((indices,j)=>{
			indices.forEach(i=>allLetters[i].continentIndex=j);
			average_position = [new paper.Point()].concat(indices).reduce((total, nxt)=>total.add(allLetters[nxt].position)).divide(indices.length)
			return {indices:indices, offset: new paper.Point(), velocity: new paper.Point({angle: Math.random()*360, length:DRIFT_SPEED}), position:average_position}
		})


		new Link(range(51,54), {x:130, y:135}, 'index.html', 55);
		new Link([...range(56,61),63], {x:1015, y:268}, 'https://github.com/PieZu', 62);
		new Link(range(64,71), {x:552, y:666}, 'credits.html', 72, 2);
	}

	/*pathee = Pathos.map((obj,i)=>{obj[1].segments = obj[1].segments.map((segment,j)=>[[trSeg[i][j].x, trSeg[i][j].y], ...segment.slice(1)]); return obj})*/
</script>
</head>
<body>
	<canvas id="myCanvas" style="height:100%; width:100%"></canvas>
</body>
</html>